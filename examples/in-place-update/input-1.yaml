---
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: a-service
  labels:
    # comment woo
    austin-powers: "yeah-baby"
    austin-powers/mini-me: "was here"
  annotations:
    kubernetes.io/ingress.class: nginx
spec:
  tls:
  - hosts: ["example.com"]
  rules:
  - host: "example.com"
    pathType: Prefix
    http:
      paths:
      - path: /
        backend:
          serviceName: a-service
          servicePort: http
      - path: /another/path
        backend:
          serviceName: another-service
          servicePort: http-another-path
      - path: /what
        backend:
          serviceName: yeah-service
          servicePort: 8443
  # say goodbye to this comment
  - host: "example.com"
    # blue 42
    http:
      paths:
      - path: /assets
        backend:
          serviceName: assets-service
          servicePort: 8080
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: botkube
  labels:
    app.kubernetes.io/name: botkube
    helm.sh/chart: botkube-v0.12.1
    app.kubernetes.io/instance: botkube
    app.kubernetes.io/managed-by: Helm
    component: controller
    app: botkube
spec:
  replicas: 1
  selector:
    matchLabels:
      component: controller
      app: botkube
  template:
    metadata:
      labels:
        component: controller
        app: botkube
    spec:
      priorityClassName: "p4"
      serviceAccountName: botkube-sa
      containers:
      - name: botkube
        image: "infracloudio/botkube:v0.12.1"
        imagePullPolicy: IfNotPresent
        securityContext:
          allowPrivilegeEscalation: false
          privileged: false
          readOnlyRootFilesystem: true
        volumeMounts:
        - name: config-volume
          mountPath: "/config"
        env:
        - name: CONFIG_PATH
          value: "/config/"
        - name: LOG_LEVEL
          value: "info"
        - name: BOTKUBE_VERSION
          value: v0.12.1
        - name: METRICS_PORT
          value: "2112"
        resources:
          limits:
            cpu: 1000m
            memory: 300Mi
          requests:
            cpu: 10m
            memory: 200Mi
      volumes:
      - name: config-volume
        projected:
          sources:
          - configMap:
              name: botkube-configmap
          - secret:
              name: botkube-communication-secret
      securityContext:
        runAsUser: 101
        runAsGroup: 101
